import{j as e,r as o,d as j,e as h,L as f}from"./vendor-core-CVn978f7.js";import{L as C,y as S}from"./index-CZyFl0Li.js";import{T as m}from"./index-BU_B9Ap-.js";import{b as L,aj as b,Z as v,ak as w,al as I,am as N,a7 as z,an as E,X as U,ao as M,H as O,ap as A,i as R,U as F}from"./vendor-icons-BvP0H4xj.js";import{m as g,o as P}from"./firebase-B2pyU7xz.js";import{CartFloatButton as W}from"./CartFloatButton-BQZCgCMY.js";import{C as D}from"./drawer-cart-DypxYsUP.js";import{P as H}from"./ProviderLayout-Adcfx3ho.js";const T=({className:r="",...s})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,...s,children:[e.jsx("path",{d:"m18 14-1-3"}),e.jsx("path",{d:"m3 9 6 2a2 2 0 0 1 2-2h2a2 2 0 0 1 1.99 1.81"}),e.jsx("path",{d:"M8 17h3a1 1 0 0 0 1-1 6 6 0 0 1 6-6 1 1 0 0 0 1-1v-.75A5 5 0 0 0 17 5"}),e.jsx("circle",{cx:"19",cy:"17",r:"3"}),e.jsx("circle",{cx:"5",cy:"17",r:"3"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"0",y1:"15",x2:"2",y2:"15"})]});function $(r){return{client:"/dashboard/client",delivery:"/dashboard/delivery",business:"/dashboard/business"}[r.type]??null}function B({user:r,className:s}){const[i,t]=o.useState(!1),a=o.useRef(null),[n,l]=o.useState(!1);o.useEffect(()=>{const c=d=>{a.current&&(a.current.contains(d.target)||t(!1))};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]);const p=$(r);function x(){j.post("/logout",{},{onStart:()=>l(!0),onFinish:()=>l(!1)})}return e.jsx("div",{className:`flex items-center ${s}`,children:e.jsxs("div",{ref:a,className:"relative",children:[e.jsxs("button",{onClick:()=>t(c=>!c),className:`flex items-center gap-2 rounded-full border p-1 transition-all duration-300 ${i?"border-purple-200 bg-purple-50 shadow-md":"border-gray-200 bg-white hover:border-purple-200 hover:shadow-sm"}`,children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-gradient-to-tr from-purple-600 to-purple-400 text-[13px] font-bold text-white shadow-inner",children:r?.name?.charAt(0).toUpperCase()}),e.jsx("span",{className:"hidden pr-1 text-sm font-bold text-gray-700 md:block",children:r?.name.split(" ")[0]}),e.jsx(L,{className:`h-4 w-4 text-gray-400 transition-transform duration-300 ${i?"rotate-180":""}`})]}),i&&e.jsxs("div",{className:"absolute right-0 z-50 mt-3 w-64 origin-top-right rounded-[1.5rem] border border-gray-100 bg-white p-2 shadow-2xl ring-1 shadow-purple-900/10 ring-black/5 transition-all",children:[e.jsxs("div",{className:"mb-1 border-b border-gray-50 px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-bold tracking-widest text-gray-400 uppercase",children:"Cuenta"}),e.jsx("p",{className:"truncate text-sm font-extrabold text-gray-800",children:r?.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:p,className:"flex items-center gap-3 rounded-xl px-4 py-2.5 text-sm font-semibold text-gray-600 transition-colors hover:bg-purple-50 hover:text-purple-700",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Panel de Control"})]}),r.type==m.CLIENT&&e.jsxs("a",{href:"/favorites",className:"flex items-center gap-3 rounded-xl px-4 py-2.5 text-sm font-semibold text-gray-600 transition-colors hover:bg-orange-50 hover:text-orange-700",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Mis Favoritos"})]})]}),e.jsx("div",{className:"mt-2 border-t border-gray-50 pt-2",children:e.jsxs("button",{onClick:x,disabled:n,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2.5 text-sm font-bold text-white shadow-lg shadow-orange-200 transition-all hover:from-orange-600 hover:to-orange-700 active:scale-[0.98] disabled:opacity-70",children:[n?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-t-white"}):e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{children:n?"Saliendo...":"Cerrar sesión"})]})})]})]})})}function _(){const{auth:r}=h().props,{user:s}=r,t={[m.DELIVERY]:e.jsx(T,{className:"h-6 w-6 text-purple-900"}),[m.CLIENT]:e.jsx(E,{className:"h-6 w-6 text-purple-900"}),[m.BUSINESS]:e.jsx(z,{className:"h-6 w-6 text-purple-900"})}[s?.type]||null;return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b border-purple-100 bg-red-900 bg-white/80",children:e.jsx("div",{className:"px-2",children:e.jsxs("div",{className:"flex h-13 items-center justify-between gap-2",children:[e.jsx("div",{className:"hidden items-center gap-1 md:flex",children:e.jsxs(f,{href:"/",className:"group flex items-center gap-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-purple-600 shadow-md transition-transform group-active:scale-90 sm:h-9 sm:w-9",children:e.jsx("span",{className:"text-lg font-bold text-white",children:"F"})}),e.jsx("h1",{className:"text-sm font-black tracking-tight text-purple-900 sm:text-base",children:"Findy"}),t]})}),e.jsxs("div",{className:"flex flex-1 items-center justify-between gap-1.5 md:hidden",children:[e.jsx("span",{}),e.jsxs("h1",{className:"text-md flex items-center gap-2 font-black tracking-tight text-purple-900 sm:text-base",children:["Findy",t]}),e.jsx("span",{})]}),e.jsxs("div",{className:"hidden flex-1 items-center justify-end gap-1.5 sm:gap-4 md:flex",children:[e.jsxs("a",{href:"https://forms.gle/NT3EPoh1VyRUuQKG6",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 rounded-xl border border-purple-100 bg-purple-50/50 p-2 text-sm font-bold text-purple-700 transition-all hover:bg-purple-100 active:scale-95 sm:px-3 sm:py-1.5",children:[e.jsx(I,{className:"h-5 w-5 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Sugerencias"})]}),s?e.jsx(B,{user:s}):e.jsxs(f,{href:"/login",className:"group flex items-center gap-2 rounded-lg bg-purple-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition-all hover:bg-purple-700 active:scale-95",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:"Entrar"})]})]})]})})})}function G(){const{auth:r}=h().props,{user:s}=r,{url:i}=h(),[t,a]=o.useState(!1),[n,l]=o.useState(!1),p=()=>{j.post("/logout",{},{onStart:()=>l(!0),onFinish:()=>{l(!1),a(!1)}})},x=d=>d==="/"?i==="/":i.startsWith(d),c=()=>a(!t);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:c,className:"fixed top-2 left-2 z-[60] flex h-8 w-8 items-center justify-center rounded-xl border border-gray-300 bg-white text-purple-600 shadow-lg transition-transform active:scale-90 md:hidden",children:t?e.jsx(U,{size:24}):e.jsx(M,{size:20})}),t&&e.jsx("div",{className:"fixed inset-0 z-[51] bg-slate-900/40 backdrop-blur-sm md:hidden",onClick:c}),e.jsx("nav",{className:`fixed top-0 left-0 z-[55] h-full w-[250px] transform bg-white transition-transform duration-300 md:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"bg-gray-50/50 p-6 pt-8",children:s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-gradient-to-tr from-purple-600 to-purple-400 text-lg font-bold text-white shadow-lg",children:s.name?.charAt(0).toUpperCase()}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"truncate text-sm font-extrabold text-gray-800",children:s.name}),e.jsx("p",{className:"truncate text-[11px] font-medium tracking-wider text-gray-400 uppercase",children:s.email})]})]})}),e.jsxs("div",{className:"flex-1 space-y-1 overflow-y-auto p-4",children:[e.jsx("p",{className:"px-4 pb-2 text-[10px] font-bold tracking-[0.2em] text-gray-400 uppercase",children:"Menú Principal"}),e.jsx(u,{href:"/",icon:e.jsx(O,{size:16}),label:"Inicio",active:x("/"),onClick:()=>a(!1)}),s&&e.jsxs(e.Fragment,{children:[e.jsx(u,{href:"/dashboard",icon:e.jsx(b,{size:16}),label:"Panel de Control",active:x("/dashboard"),onClick:()=>a(!1)}),e.jsx(u,{href:"/favorites",icon:e.jsx(v,{size:16}),label:"Mis Favoritos",active:x("/favorites"),onClick:()=>a(!1),variant:"orange"}),e.jsx(u,{href:"/profile",icon:e.jsx(A,{size:16}),label:"Ajustes Perfil",active:x("/profile"),onClick:()=>a(!1)})]})]}),e.jsx("div",{className:"border-t border-gray-100 p-4",children:s?e.jsxs("button",{onClick:p,disabled:n,className:"flex w-full items-center justify-center gap-3 rounded-2xl bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-3.5 text-sm font-bold text-white shadow-lg shadow-orange-200 transition-all active:scale-[0.97] disabled:opacity-70",children:[n?e.jsx(R,{size:18,className:"animate-spin"}):e.jsx(w,{size:18}),e.jsx("span",{children:n?"Saliendo...":"CERRAR SESIÓN"})]}):e.jsxs(f,{href:"/login",onClick:()=>a(!1),className:"flex w-full items-center justify-center gap-2 rounded-2xl bg-purple-600 px-2 py-1.5 text-sm font-bold text-white shadow-lg shadow-purple-200",children:[e.jsx(N,{size:16}),e.jsx("span",{children:"Ingresar"})]})})]})})]})}function u({href:r,icon:s,label:i,active:t,onClick:a,variant:n="purple"}){const l={purple:"bg-purple-50 text-purple-700 border-purple-100",orange:"bg-orange-50 text-orange-700 border-orange-100"};return e.jsxs(f,{href:r,onClick:a,className:`group flex items-center justify-between rounded-xl border border-transparent px-4 py-3 transition-all duration-200 active:scale-[0.98] ${t?l[n]:"text-gray-500 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`${t?"scale-110":"text-gray-400 group-hover:text-gray-600"}`,children:s}),e.jsx("span",{className:"text-sm font-bold tracking-tight uppercase",children:i})]}),t&&e.jsx(F,{size:14,className:"opacity-40"})]})}function K(){const[r,s]=o.useState(!1),[i,t]=o.useState(null);return o.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(n=>{n.waiting&&(t(n.waiting),s(!0)),n.addEventListener("updatefound",()=>{const l=n.installing;l&&l.addEventListener("statechange",()=>{l.state==="installed"&&navigator.serviceWorker.controller&&(t(l),s(!0))})})})},[]),{updateAvailable:r,refreshApp:()=>{i&&(i.postMessage("SKIP_WAITING"),window.location.reload())}}}function se({children:r,showFloatShoppingCart:s=!0}){const[i,t]=o.useState(!1),{cart:a,auth:n}=h().props,l=Object.values(a),p=n?.user,x=l.length;return K(),o.useEffect(()=>{if(!g)return;const c=P(g,d=>{const y=d.notification?.title||d.data?.title||"Nuevo pedido",k=d.notification?.body||d.data?.body||"";S.success(e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:y}),e.jsx("p",{className:"text-[10px]",children:k})]}))});return()=>c()},[]),e.jsx(H,{children:e.jsxs("main",{className:"relative z-10 min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsx(C,{position:"top-right",className:"!z-[9999]",autoClose:1800}),e.jsx(_,{}),e.jsx("div",{className:"relative z-10 w-full max-w-6xl p-1 md:mx-auto md:max-w-7xl",children:r}),p&&e.jsxs(e.Fragment,{children:[s&&e.jsx(W,{totalItems:x,onClick:()=>t(!0)}),e.jsx(D,{isOpen:i,onClose:()=>t(!1)})]}),e.jsx(G,{})]})})}export{se as M};
