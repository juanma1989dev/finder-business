import{r as c,u as v,j as e}from"./vendor-core-exSyXSqW.js";import{C as p,a as y}from"./card-D5k2MC8Y.js";import{I as C}from"./input-3TT18shE.js";import{L as u}from"./label-BJtWGace.js";import{S,a as L,b as T,c as M,d as k}from"./select-BqBcghbi.js";import{l as i}from"./locations-zddfFc1m.js";import{m as z}from"./dashboard-layout-BNlDeZF5.js";import"./app-Dpu3mrQQ.js";import{y as x}from"./index-zdFYkwEh.js";import{LayoutBusinessModules as F}from"./LayoutBusinessModules-Cmk1G79k.js";import{a6 as w,q as E,e as I}from"./vendor-icons-C0rekE6d.js";import{u as O,M as D,T as H,a as R}from"./TileLayer-Ck5D7tC8.js";import"./utils-ZvPxgyVA.js";import"./vendor-ui-BC6GVMXR.js";import"./button-DROHPe1W.js";import"./dropdown-menu-Dz3g0mub.js";import"./index-CN9EY2cw.js";import"./index-CVASjcgI.js";import"./index-BU_B9Ap-.js";import"./app-ho6zMTOc.js";function U(){return O().map}function A({position:s,enabled:o}){const t=U();return c.useEffect(()=>{o&&t.flyTo(s,16,{animate:!0,duration:.5})},[s,o,t]),null}function ce({business:s}){const o=z({text:"Ubicación",url:"#"}),t=i.NOCHIXTLAN.cords,[d,g]=c.useState(!1),[h,m]=c.useState(!1),{data:a,setData:l,put:f,processing:j}=v({location:s.location,address:s.address,cords:{lat:s?.cords?.coordinates?.[1]??t.lat,long:s?.cords?.coordinates?.[0]??t.long}});c.useEffect(()=>{const r=setTimeout(()=>g(!0),100);return()=>clearTimeout(r)},[]);const b=()=>{f(`/dashboard/business/${s.id}-${s.slug}/location`,{preserveScroll:!0,onSuccess:()=>x.success("Ubicación actualizada correctamente"),onError:()=>x.error("Error al guardar")})};return e.jsxs(F,{titleHead:"Localización",headerTitle:"Ubicación",headerDescription:"Configura la localización física del negocio",buttonText:"Guardar cambios",icon:w,onSubmit:b,processing:j,breadcrumbs:o,children:[e.jsx("div",{className:"space-y-6 lg:col-span-4",children:e.jsx(p,{className:"rounded-lg border-purple-200 shadow-sm",children:e.jsxs(y,{className:"space-y-4 p-3",children:[e.jsxs("div",{children:[e.jsx(u,{className:"mb-1 block text-[10px] font-semibold tracking-widest text-gray-500 uppercase",children:"Municipio / Localidad"}),e.jsxs(S,{value:a.location,onValueChange:r=>{m(!0),l({...a,location:r,cords:i[r].cords,address:""})},children:[e.jsx(L,{children:e.jsx(T,{placeholder:"Seleccionar…"})}),e.jsx(M,{children:Object.entries(i).map(([r,n])=>e.jsx(k,{value:r,children:n.name},r))})]})]}),e.jsxs("div",{children:[e.jsx(u,{className:"mb-1 block text-[10px] font-semibold tracking-widest text-gray-500 uppercase",children:"Dirección"}),e.jsx(C,{value:a.address,onChange:r=>l("address",r.target.value),placeholder:"Calle, número, colonia…"}),e.jsxs("div",{className:"mt-3 flex gap-2 rounded-lg border border-amber-200 bg-amber-50 p-2",children:[e.jsx(E,{size:14,className:"text-amber-600"}),e.jsx("p",{className:"flex text-sm text-amber-700",children:"Ajusta el marcador para mayor precisión."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2 text-center",children:[e.jsx("span",{className:"block text-[9px] text-gray-500 uppercase",children:"Latitud"}),e.jsx("span",{className:"font-mono text-xs",children:a.cords.lat.toFixed(6)})]}),e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2 text-center",children:[e.jsx("span",{className:"block text-[9px] text-gray-500 uppercase",children:"Longitud"}),e.jsx("span",{className:"font-mono text-xs",children:a.cords.long.toFixed(6)})]})]})]})})}),e.jsx("div",{className:"relative lg:col-span-8",children:e.jsxs(p,{className:"relative h-[520px] overflow-hidden rounded-lg p-0",children:[!d&&e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/60",children:e.jsx(I,{className:"animate-spin"})}),d&&e.jsxs(D,{center:[a.cords.lat,a.cords.long],zoom:16,style:{height:"100%",width:"100%"},children:[e.jsx(H,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"© OpenStreetMap contributors"}),e.jsx(R,{position:[a.cords.lat,a.cords.long],draggable:!0,eventHandlers:{dragend:r=>{const{lat:n,lng:N}=r.target.getLatLng();m(!1),l("cords",{lat:Number(n.toFixed(6)),long:Number(N.toFixed(6))})}}}),e.jsx(A,{enabled:h,position:[a.cords.lat,a.cords.long]})]})]})})]})}export{ce as default};
