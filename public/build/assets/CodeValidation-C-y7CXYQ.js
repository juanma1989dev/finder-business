import{u as h,j as e,d as g,r as c,e as b,H as w}from"./vendor-core-CVn978f7.js";import{g as v,D as N}from"./dashboard-layout-DBIvlQ1a.js";import{y as a,L as y}from"./index-CZyFl0Li.js";import{af as S,R as E}from"./vendor-icons-BvP0H4xj.js";import"./vendor-ui-CpttHis2.js";import"./button--cW8-JAs.js";import"./utils-szUE-hBx.js";import"./dropdown-menu-BbU8JRam.js";import"./index-CN9EY2cw.js";import"./index-CVASjcgI.js";import"./index-BU_B9Ap-.js";import"./ProviderLayout-Adcfx3ho.js";import"./firebase-B2pyU7xz.js";function k({props:u,setStausCodeValidation:r,setGeneratedCode:i,urlBusiness:s}){const{auth:d}=u,{user:t}=d,{post:p,processing:o}=h({email:t?.email||""}),n=()=>{p("/dashboard/profile/business/code-to-create",{preserveScroll:!0,onSuccess:m=>{const l=m.props?.flash?.meta;if(!v(l,"code")){a.error("No se pudo obtener el código.");return}},onError:()=>a.error("Error al generar el código.")})};return e.jsxs("div",{className:"mt-4 flex flex-col items-center justify-center gap-6 p-3",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Generar código"}),e.jsxs("div",{className:"w-full max-w-lg text-center",children:[e.jsx("p",{children:"Para registrar su negocio, es necesario validar previamente su identidad."}),e.jsx("p",{children:"Enviaremos un código de confirmación a su correo electrónico."})]}),e.jsxs("div",{className:"flex w-full max-w-lg justify-center gap-5",children:[e.jsxs("button",{disabled:o,className:`flex items-center gap-3 rounded-md bg-red-600 px-4 py-2 text-white hover:bg-red-700 ${o?"cursor-not-allowed bg-gray-400":"cursor-pointer bg-gray-200 hover:bg-gray-300"}`,onClick:()=>g.get(s),children:[e.jsx(S,{className:"h-4 w-4"}),"Cancelar"]}),e.jsxs("button",{onClick:n,disabled:o,className:`flex items-center justify-center gap-3 rounded-md bg-sky-600 px-4 py-2 text-white hover:bg-sky-700 ${o?"cursor-not-allowed bg-gray-400":"cursor-pointer"}`,children:[e.jsx(E,{className:"h-4 w-4"}),o?e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):"Recibir código"]})]})]})}function V({props:u,code:r}){const[i]=c.useState(180),[s,d]=c.useState(""),{auth:t}=b().props,{user:p}=t,o=p?.email,{processing:n,post:m}=h({code:r,email:o});c.useEffect(()=>{r&&a.success("El código se envió correctamente.")},[]);const x=async()=>{s===r?m("/dashboard/profile/business/validate-code",{preserveScroll:!0,onSuccess:l=>{const C=l.props?.flash?.meta;if(v(C,"validated")>0)return g.get("/dashboard/business/create",{validate:btoa(r)});a.error("Error al validar el código")},onError:()=>{a.error("Error al validar el código")}}):a.error("Código incorrecto")};return e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-6 p-3 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsxs("span",{children:["El código es válido por: ",Math.floor(i/60),":",(i%60).toString().padStart(2,"0")," minutos."]}),e.jsx("input",{type:"text",placeholder:"Ingresa el código",value:s,onChange:l=>d(l.target.value),className:"w-full rounded-md border p-2"}),e.jsx("button",{onClick:x,disabled:n,className:`flex items-center justify-center rounded-md px-4 py-2 text-white ${n?"cursor-not-allowed bg-green-300":"cursor-pointer bg-green-500 hover:opacity-90"}`,children:n?e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):"Validar código"})]})})}const L=[{title:"Dashboard - Nuevo negocio",href:""}],f="/dashboard/profile/business/";function z({numBusiness:u}){const[r,i]=c.useState(!1),[s,d]=c.useState(null),t=b().props;return u>=5?g.visit(f):e.jsxs(N,{breadcrumbs:L,children:[e.jsx(y,{}),e.jsx(w,{title:"Dashboard - Nuevo negocio - "}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:e.jsx("div",{className:"relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 md:min-h-min dark:border-sidebar-border",children:!r&&!s?e.jsx(k,{props:t,stausCodeValidation:r,setStausCodeValidation:i,generatedCode:s,setGeneratedCode:d,urlBusiness:f}):e.jsx(V,{props:t,code:s})})})]})}export{z as default};
