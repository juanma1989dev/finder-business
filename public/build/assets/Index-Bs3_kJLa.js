import{r as s,j as t,a as w}from"./app-DRnaFo71.js";import{D as k}from"./dashboard-layout-B63ifu4J.js";import{O as i}from"./OrderCard-wMlcHRJQ.js";import{y as g}from"./index-Dgc8qQOq.js";import L from"./GridOrders-DgNYdRCT.js";import T from"./NotesDialog-nFm6dGSs.js";import h from"./Stat-Cu5tjESQ.js";import{P as R,i as A}from"./utils-B8V9t6OR.js";import{a as B}from"./star-C33ZpR1w.js";import"./app-_ZmoGD8T.js";import"./button-oOZJaIDN.js";import"./index-DAOhb2hJ.js";import"./clsx-COCWedHH.js";import"./createLucideIcon-8cOpsgex.js";import"./index-DXUyvkal.js";import"./index-CDS2P9IT.js";import"./index-_ty5M1Kx.js";import"./index-CJG-LqGM.js";import"./x-BkmaQkV6.js";import"./index-CAsWk8_c.js";import"./index-ByFY5vBa.js";import"./dropdown-menu-DAxWnPxA.js";import"./index-BqgYRoRh.js";import"./index-kNrJbDCw.js";import"./index-BCw_eWvc.js";import"./index-CVASjcgI.js";import"./house-BvvIOFlQ.js";import"./shopping-bag-D6HcC1f4.js";import"./loader-circle-DK9NHL9l.js";import"./useOrderStatus-DngeDh-a.js";import"./package-PXuZgzM8.js";import"./triangle-alert-BPl7zri6.js";import"./package-search-CwpuKR2z.js";import"./arrow-right-FvoTZcqC.js";import"./circle-alert-DLeoRx40.js";import"./printer-CQ4wc93D.js";import"./shield-check-DZxu-W88.js";import"./trash-2-B_LJmt8F.js";import"./plus-D6693a4f.js";import"./shopping-cart-CMRXSugC.js";var E=(o=>(o.Todos="Todos",o.Pendiente="Pendiente",o.Confirmado="Confirmado",o.Entregado="Entregado",o))(E||{});const F=[i.CANCELLED,i.REJECTED];function Se({breadcrumbs:o,orders:p,business:d}){const[u,b]=s.useState(!!d?.is_open),[n,N]=s.useState("Todos"),[c,S]=s.useState(""),[C,v]=s.useState(null),[a,m]=s.useState({open:!1}),[l,x]=s.useState("");s.useEffect(()=>{const e=r=>{r.key==="Escape"&&(m({open:!1}),x("")),r.key==="Enter"&&a.open&&l.trim()&&f(a.orderId,a.status,l)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,l]);const y=()=>{const e=u;b(!e),w.patch(`/dashboard/business/${d.id}-${d.slug}/opening-hours`,{id:d.id,status:!e},{onError:()=>{b(e),g.error("No se pudo actualizar el negocio")}})},D=(e,r)=>{if(r&&F.includes(r)){m({open:!0,orderId:e,status:r});return}f(e,r)},f=(e,r,I)=>{v(e),w.patch(`/dashboard/orders/${e}/status`,{status:r,note:I},{preserveScroll:!0,onSuccess:()=>{g.success("Pedido actualizado"),m({open:!1}),x("")},onError:()=>g.error("Error al actualizar pedido"),onFinish:()=>v(null)})},j=s.useMemo(()=>p.filter(e=>{if(c){const r=c.toLowerCase();if(!e.id.toString().includes(r)&&!e.user?.name?.toLowerCase().includes(r))return!1}return n==="Pendiente"?e.status===i.PENDING:n==="Confirmado"?e.status===i.CONFIRMED:n==="Entregado"?e.status===i.DELIVERED:!0}),[p,c,n]),O=p.filter(e=>e.status===i.PENDING).length,P=p.filter(e=>e.status===i.PENDING).length;return t.jsxs(k,{breadcrumbs:o,children:[t.jsxs("div",{className:"flex min-h-screen flex-col gap-3 bg-purple-50/30 p-2 sm:p-2 lg:p-4",children:[t.jsxs("div",{className:"sticky top-14 z-40 rounded-lg border border-purple-200 bg-white p-2 shadow-sm sm:static",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-base font-semibold tracking-tight text-purple-800 uppercase",children:"Pedidos"}),t.jsx("p",{className:"text-[10px] font-normal tracking-widest text-gray-500 uppercase",children:"Gestión de tus pedidos."})]}),t.jsx("button",{onClick:y,className:`flex cursor-pointer items-center gap-2 rounded-lg px-4 py-2 text-[10px] font-semibold uppercase transition-all active:scale-95 ${u?"bg-purple-600 text-white shadow-sm":"border border-amber-200 bg-amber-50 text-amber-700"}`,children:u?t.jsxs(t.Fragment,{children:["Abierto ",t.jsx(R,{className:"h-3.5 w-3.5"})]}):t.jsxs(t.Fragment,{children:["Cerrado ",t.jsx(A,{className:"h-3.5 w-3.5"})]})})]}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[t.jsx(h,{label:"Pendientes",value:O}),t.jsx(h,{label:"Retrasados",value:P,danger:!0}),t.jsx(h,{label:"Filtrados",value:j.length})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx(B,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-gray-400"}),t.jsx("input",{className:"w-full rounded-lg border border-purple-200 bg-white py-3 pr-4 pl-10 text-sm font-normal text-gray-700 shadow-sm transition-all focus:border-purple-600 focus:ring-1 focus:ring-purple-600 focus:outline-none",placeholder:"Buscar pedido o cliente…",value:c,onChange:e=>S(e.target.value)})]}),t.jsx("div",{className:"scrollbar-hide flex gap-2 overflow-x-auto pb-1",children:Object.values(E).map(e=>t.jsx("button",{onClick:()=>N(e),className:`rounded-lg px-4 py-2 text-[10px] font-semibold whitespace-nowrap uppercase transition-all active:scale-95 ${n===e?"bg-purple-600 text-white shadow-sm":"border border-purple-100 bg-white text-gray-500 hover:bg-purple-50"}`,children:e},e))}),t.jsx("div",{className:"relative min-h-[400px]",children:t.jsx(L,{orders:j,loadingOrderId:C,onChangeStatus:D})})]}),t.jsx(T,{open:a.open,value:l,onChange:x,onClose:()=>m({open:!1,orderId:null,status:void 0}),onConfirm:()=>f(a.orderId,a.status,l)})]})}export{Se as default};
