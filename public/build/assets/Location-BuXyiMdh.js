import{r as i,u as N,j as e}from"./vendor-core-exSyXSqW.js";import{u as v,M as y,a as S,b as C}from"./icons-DUN4oFg2.js";import{C as x,a as L}from"./card-D5k2MC8Y.js";import{I as M}from"./input-3TT18shE.js";import{L as u}from"./label-BJtWGace.js";import{S as T,a as k,b as E,c as F,d as I}from"./select-BqBcghbi.js";import{l as m}from"./locations-zddfFc1m.js";import{m as w}from"./dashboard-layout-BNlDeZF5.js";import"./app-Lsx9vzYk.js";import{y as g}from"./index-zdFYkwEh.js";import{LayoutBusinessModules as z}from"./LayoutBusinessModules-Cmk1G79k.js";import{a6 as D,q as R,e as U}from"./vendor-icons-C0rekE6d.js";import"./utils-ZvPxgyVA.js";import"./vendor-ui-BC6GVMXR.js";import"./button-DROHPe1W.js";import"./dropdown-menu-Dz3g0mub.js";import"./index-CN9EY2cw.js";import"./index-CVASjcgI.js";import"./index-BU_B9Ap-.js";import"./app-UAH-NDiG.js";function A({position:s,enabled:l=!0,zoom:o,animate:t=!0}){const c=v();return i.useEffect(()=>{l&&c.flyTo(s,o??c.getZoom(),{animate:t,duration:t?.6:0})},[s,l,o,c]),null}function oe({business:s}){const l=w({text:"Ubicación",url:"#"}),o=m.NOCHIXTLAN.cords,[t,c]=i.useState(!1),[f,p]=i.useState(!1),{data:a,setData:n,put:h,processing:b}=N({location:s.location,address:s.address,cords:{lat:s?.cords?.coordinates?.[1]??o.lat,long:s?.cords?.coordinates?.[0]??o.long}});i.useEffect(()=>{const r=setTimeout(()=>c(!0),100);return()=>clearTimeout(r)},[]);const j=()=>{h(`/dashboard/business/${s.id}-${s.slug}/location`,{preserveScroll:!0,onSuccess:()=>g.success("Ubicación actualizada correctamente"),onError:()=>g.error("Error al guardar")})};return e.jsxs(z,{titleHead:"Localización",headerTitle:"Ubicación",headerDescription:"Configura la localización física del negocio",buttonText:"Guardar cambios",icon:D,onSubmit:j,processing:b,breadcrumbs:l,children:[e.jsx("div",{className:"space-y-6 lg:col-span-4",children:e.jsx(x,{className:"rounded-lg border-purple-200 shadow-sm",children:e.jsxs(L,{className:"space-y-4 p-3",children:[e.jsxs("div",{children:[e.jsx(u,{className:"mb-1 block text-[10px] font-semibold tracking-widest text-gray-500 uppercase",children:"Municipio / Localidad"}),e.jsxs(T,{value:a.location,onValueChange:r=>{p(!0),n({...a,location:r,cords:m[r].cords,address:""})},children:[e.jsx(k,{children:e.jsx(E,{placeholder:"Seleccionar…"})}),e.jsx(F,{children:Object.entries(m).map(([r,d])=>e.jsx(I,{value:r,children:d.name},r))})]})]}),e.jsxs("div",{children:[e.jsx(u,{className:"mb-1 block text-[10px] font-semibold tracking-widest text-gray-500 uppercase",children:"Dirección"}),e.jsx(M,{value:a.address,onChange:r=>n("address",r.target.value),placeholder:"Calle, número, colonia…"}),e.jsxs("div",{className:"mt-3 flex gap-2 rounded-lg border border-amber-200 bg-amber-50 p-2",children:[e.jsx(R,{size:14,className:"text-amber-600"}),e.jsx("p",{className:"flex text-sm text-amber-700",children:"Ajusta el marcador para mayor precisión."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2 text-center",children:[e.jsx("span",{className:"block text-[9px] text-gray-500 uppercase",children:"Latitud"}),e.jsx("span",{className:"font-mono text-xs",children:a.cords.lat.toFixed(6)})]}),e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2 text-center",children:[e.jsx("span",{className:"block text-[9px] text-gray-500 uppercase",children:"Longitud"}),e.jsx("span",{className:"font-mono text-xs",children:a.cords.long.toFixed(6)})]})]})]})})}),e.jsx("div",{className:"relative lg:col-span-8",children:e.jsxs(x,{className:"relative h-[520px] overflow-hidden rounded-lg p-0",children:[!t&&e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/60",children:e.jsx(U,{className:"animate-spin"})}),t&&e.jsxs(y,{center:[a.cords.lat,a.cords.long],children:[e.jsx(S,{position:[a.cords.lat,a.cords.long],draggable:!0,icon:C,onDragEnd:(r,d)=>{p(!1),n("cords",{lat:Number(r.toFixed(6)),long:Number(d.toFixed(6))})}}),e.jsx(A,{enabled:f,position:[a.cords.lat,a.cords.long],zoom:16})]})]})})]})}export{oe as default};
