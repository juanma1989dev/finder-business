import{r as d,u as N,j as e}from"./vendor-core-VmliHTPN.js";import{B as m}from"./button-QYsVwpqb.js";import{C as w}from"./card-Nn_fXJt4.js";import{m as G}from"./dashboard-layout-DctQTAKd.js";import{c as z}from"./utils-DA-8Si8A.js";import{y as p}from"./index-DdSA57g9.js";import{LayoutBusinessModules as $}from"./LayoutBusinessModules-BaadMert.js";import{I as u,P as k,S as n,T as S}from"./vendor-icons-AXEXEb4U.js";import"./vendor-ui-BLZZ21YU.js";import"./dropdown-menu-CWFYYrp0.js";import"./index-BCw_eWvc.js";import"./index-CVASjcgI.js";function T({business:l}){const h=G({text:`${l.name??""} - Galería`,url:"/"}),[o,i]=d.useState(()=>l.images.map((r,a)=>({...r,id:r.id||`existing-${a}-${Date.now()}`}))),{setData:x,post:g,processing:f}=N({images:[]});d.useEffect(()=>{x("images",o)},[o]);const b=r=>{const a=r.target.files;if(!a)return;const s=Array.from(a).map((t,c)=>({id:`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}-${c}`,file:t,url:URL.createObjectURL(t),is_primary:o.length===0&&c===0}));i(t=>[...t,...s])},j=r=>{i(a=>{const s=a.find(t=>t.id===r);return s?.url.startsWith("blob:")&&URL.revokeObjectURL(s.url),a.filter(t=>t.id!==r)})},y=r=>{i(a=>a.map(s=>({...s,is_primary:s.id===r}))),p.info("Imagen principal actualizada",{icon:e.jsx(n,{className:"fill-orange-500 text-orange-500",size:14})})},v=()=>{g(`/dashboard/business/${l.id}-${l.slug}/gallery`,{forceFormData:!0,onSuccess:()=>p.success("Galería sincronizada correctamente")})};return e.jsxs($,{titleHead:"Galería",headerTitle:"Galería Multimedia",headerDescription:"Gestiona las fotos de tu negocio y selecciona la portada principal.",buttonText:"Guardar Galería",icon:u,onSubmit:v,processing:f,breadcrumbs:h,children:[e.jsxs("div",{className:"lg:col-span-4",children:[e.jsx("input",{type:"file",id:"gallery-upload",multiple:!0,accept:"image/*",onChange:b,className:"hidden"}),e.jsxs("label",{htmlFor:"gallery-upload",className:"group flex h-full min-h-[200px] cursor-pointer flex-col items-center justify-center rounded-2xl border-2 border-dashed border-slate-200 bg-white p-6 transition-all hover:border-orange-200 hover:bg-orange-50/30",children:[e.jsx("div",{className:"mb-3 flex h-12 w-12 items-center justify-center rounded-xl bg-slate-50 transition-transform group-hover:scale-110 group-hover:bg-orange-100",children:e.jsx(k,{className:"text-slate-400 group-hover:text-orange-600",size:24})}),e.jsx("span",{className:"text-sm font-bold text-slate-600 group-hover:text-orange-700",children:"Añadir Fotos"}),e.jsx("span",{className:"mt-1 text-[11px] text-slate-400",children:"JPG o PNG (Máx. 10MB por archivo)"})]})]}),e.jsx("div",{className:"lg:col-span-8",children:o.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3",children:o.map(r=>e.jsxs("div",{className:z("group relative aspect-square overflow-hidden rounded-2xl border-2 transition-all duration-300",r.is_primary?"border-orange-500 shadow-md shadow-orange-100":"border-white bg-white shadow-sm hover:border-slate-200"),children:[e.jsx("img",{src:r.url.startsWith("blob:")||r.url.startsWith("http")?r.url:`/storage/${r.url}`,alt:"Preview",className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2 bg-black/40 opacity-0 backdrop-blur-[1px] transition-opacity group-hover:opacity-100",children:[!r.is_primary&&e.jsx(m,{type:"button",size:"icon",variant:"secondary",onClick:()=>y(r.id),className:"h-9 w-9 rounded-xl bg-white/90 text-orange-600 hover:bg-white",children:e.jsx(n,{size:16,className:"fill-orange-500"})}),e.jsx(m,{type:"button",size:"icon",variant:"destructive",onClick:()=>j(r.id),className:"h-9 w-9 rounded-xl shadow-lg",children:e.jsx(S,{size:16})})]}),r.is_primary&&e.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-1 rounded-full bg-orange-600 px-3 py-1 text-[9px] font-black tracking-tighter text-white uppercase shadow-lg",children:[e.jsx(n,{size:10,className:"fill-current"}),"Portada"]})]},r.id))}):e.jsxs(w,{className:"flex h-full min-h-[200px] flex-col items-center justify-center rounded-2xl border-dashed border-slate-200 bg-slate-50/50 p-8 shadow-none",children:[e.jsx(u,{className:"mb-2 h-10 w-10 text-slate-200"}),e.jsx("p",{className:"text-xs font-medium text-slate-400",children:"No hay fotos en la galería todavía"})]})})]})}export{T as default};
