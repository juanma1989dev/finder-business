import{r as o,j as e,d as f,e as m,L as h}from"./vendor-core-VmliHTPN.js";import{L as y}from"./index-CJCtTEqR.js";import{g as k,ao as g,Q as b,ap as j,aq as v,ar as C,as as w,X as N,at as S,H as z,e as A,K as I,au as E}from"./vendor-icons-B8JTtD38.js";import{m as L,C as P}from"./drawer-cart-mVg6Zia_.js";import{CartFloatButton as O}from"./CartFloatButton-Dpm2nx2f.js";function M({user:r,className:s}){const[n,t]=o.useState(!1),l=o.useRef(null),[a,i]=o.useState(!1);o.useEffect(()=>{const c=d=>{l.current&&(l.current.contains(d.target)||t(!1))};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]);function x(){f.post("/logout",{},{onStart:()=>i(!0),onFinish:()=>i(!1)})}return e.jsx("div",{className:`flex items-center ${s}`,children:e.jsxs("div",{ref:l,className:"relative",children:[e.jsxs("button",{onClick:()=>t(c=>!c),className:`flex items-center gap-2 rounded-full border p-1 transition-all duration-300 ${n?"border-purple-200 bg-purple-50 shadow-md":"border-gray-200 bg-white hover:border-purple-200 hover:shadow-sm"}`,children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-gradient-to-tr from-purple-600 to-purple-400 text-[13px] font-bold text-white shadow-inner",children:r?.name?.charAt(0).toUpperCase()}),e.jsx("span",{className:"hidden pr-1 text-sm font-bold text-gray-700 md:block",children:r?.name.split(" ")[0]}),e.jsx(k,{className:`h-4 w-4 text-gray-400 transition-transform duration-300 ${n?"rotate-180":""}`})]}),n&&e.jsxs("div",{className:"absolute right-0 z-50 mt-3 w-64 origin-top-right rounded-[1.5rem] border border-gray-100 bg-white p-2 shadow-2xl ring-1 shadow-purple-900/10 ring-black/5 transition-all",children:[e.jsxs("div",{className:"mb-1 border-b border-gray-50 px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-bold tracking-widest text-gray-400 uppercase",children:"Cuenta"}),e.jsx("p",{className:"truncate text-sm font-extrabold text-gray-800",children:r?.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("a",{href:"/dashboard",className:"flex items-center gap-3 rounded-xl px-4 py-2.5 text-sm font-semibold text-gray-600 transition-colors hover:bg-purple-50 hover:text-purple-700",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{children:"Panel de Control"})]}),e.jsxs("a",{href:"/favorites",className:"flex items-center gap-3 rounded-xl px-4 py-2.5 text-sm font-semibold text-gray-600 transition-colors hover:bg-orange-50 hover:text-orange-700",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:"Mis Favoritos"})]}),e.jsxs("a",{href:"/profile",className:"flex items-center gap-3 rounded-xl px-4 py-2.5 text-sm font-semibold text-gray-600 transition-colors hover:bg-purple-50 hover:text-purple-700",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:"Ajustes del Perfil"})]})]}),e.jsx("div",{className:"mt-2 border-t border-gray-50 pt-2",children:e.jsxs("button",{onClick:x,disabled:a,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-2.5 text-sm font-bold text-white shadow-lg shadow-orange-200 transition-all hover:from-orange-600 hover:to-orange-700 active:scale-[0.98] disabled:opacity-70",children:[a?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/30 border-t-white"}):e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Saliendo...":"Cerrar sesión"})]})})]})]})})}function F(){const{auth:r}=m().props,{user:s}=r;return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b border-purple-100 bg-white/80",children:e.jsx("div",{className:"mx-auto max-w-7xl px-3",children:e.jsxs("div",{className:"flex h-13 items-center justify-between gap-2",children:[e.jsx("div",{className:"hidden items-center gap-1 md:flex",children:e.jsxs(h,{href:"/",className:"group flex items-center gap-2",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-purple-600 shadow-md transition-transform group-active:scale-90 sm:h-9 sm:w-9",children:e.jsx("span",{className:"text-lg font-bold text-white",children:"F"})}),e.jsx("h1",{className:"text-sm font-black tracking-tight text-purple-900 sm:text-base",children:"Findy"})]})}),e.jsxs("div",{className:"hidden flex-1 items-center justify-end gap-1.5 sm:gap-4 md:flex",children:[e.jsxs("a",{href:"https://forms.gle/NT3EPoh1VyRUuQKG6",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 rounded-xl border border-purple-100 bg-purple-50/50 p-2 text-sm font-bold text-purple-700 transition-all hover:bg-purple-100 active:scale-95 sm:px-3 sm:py-1.5",children:[e.jsx(C,{className:"h-5 w-5 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Sugerencias"})]}),s?e.jsx(M,{user:s}):e.jsxs(h,{href:"/accounts",className:"group flex items-center gap-2 rounded-lg bg-purple-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition-all hover:bg-purple-700 active:scale-95",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{children:"Entrar"})]})]})]})})})}function W(){const{auth:r}=m().props,{user:s}=r,{url:n}=m(),[t,l]=o.useState(!1),[a,i]=o.useState(!1),x=()=>{f.post("/logout",{},{onStart:()=>i(!0),onFinish:()=>{i(!1),l(!1)}})},c=p=>p==="/"?n==="/":n.startsWith(p),d=()=>l(!t);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"fixed top-2 left-2 z-[60] flex h-8 w-8 items-center justify-center rounded-xl border border-gray-300 bg-white text-purple-600 shadow-lg transition-transform active:scale-90 md:hidden",children:t?e.jsx(N,{size:24}):e.jsx(S,{size:20})}),t&&e.jsx("div",{className:"fixed inset-0 z-[51] bg-slate-900/40 backdrop-blur-sm md:hidden",onClick:d}),e.jsx("nav",{className:`fixed top-0 left-0 z-[55] h-full w-[250px] transform bg-white transition-transform duration-300 md:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"bg-gray-50/50 p-6 pt-8",children:s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-gradient-to-tr from-purple-600 to-purple-400 text-lg font-bold text-white shadow-lg",children:s.name?.charAt(0).toUpperCase()}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"truncate text-sm font-extrabold text-gray-800",children:s.name}),e.jsx("p",{className:"truncate text-[11px] font-medium tracking-wider text-gray-400 uppercase",children:s.email})]})]})}),e.jsxs("div",{className:"flex-1 space-y-1 overflow-y-auto p-4",children:[e.jsx("p",{className:"px-4 pb-2 text-[10px] font-bold tracking-[0.2em] text-gray-400 uppercase",children:"Menú Principal"}),e.jsx(u,{href:"/",icon:e.jsx(z,{size:16}),label:"Inicio",active:c("/"),onClick:()=>l(!1)}),s&&e.jsxs(e.Fragment,{children:[e.jsx(u,{href:"/dashboard",icon:e.jsx(g,{size:16}),label:"Panel de Control",active:c("/dashboard"),onClick:()=>l(!1)}),e.jsx(u,{href:"/favorites",icon:e.jsx(b,{size:16}),label:"Mis Favoritos",active:c("/favorites"),onClick:()=>l(!1),variant:"orange"}),e.jsx(u,{href:"/profile",icon:e.jsx(j,{size:16}),label:"Ajustes Perfil",active:c("/profile"),onClick:()=>l(!1)})]})]}),e.jsx("div",{className:"border-t border-gray-100 p-4",children:s?e.jsxs("button",{onClick:x,disabled:a,className:"flex w-full items-center justify-center gap-3 rounded-2xl bg-gradient-to-r from-orange-500 to-orange-600 px-4 py-3.5 text-sm font-bold text-white shadow-lg shadow-orange-200 transition-all active:scale-[0.97] disabled:opacity-70",children:[a?e.jsx(A,{size:18,className:"animate-spin"}):e.jsx(v,{size:18}),e.jsx("span",{children:a?"Saliendo...":"CERRAR SESIÓN"})]}):e.jsxs(h,{href:"/login",onClick:()=>l(!1),className:"flex w-full items-center justify-center gap-2 rounded-2xl bg-purple-600 px-2 py-1.5 text-sm font-bold text-white shadow-lg shadow-purple-200",children:[e.jsx(w,{size:18}),e.jsx("span",{children:"ENTRAR A MI CUENTA"})]})})]})})]})}function u({href:r,icon:s,label:n,active:t,onClick:l,variant:a="purple"}){const i={purple:"bg-purple-50 text-purple-700 border-purple-100",orange:"bg-orange-50 text-orange-700 border-orange-100"};return e.jsxs(h,{href:r,onClick:l,className:`group flex items-center justify-between rounded-xl border border-transparent px-4 py-3 transition-all duration-200 active:scale-[0.98] ${t?i[a]:"text-gray-500 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`${t?"scale-110":"text-gray-400 group-hover:text-gray-600"}`,children:s}),e.jsx("span",{className:"text-sm font-bold tracking-tight uppercase",children:n})]}),t&&e.jsx(I,{size:14,className:"opacity-40"})]})}function R(){const[r,s]=o.useState(null),[n,t]=o.useState(!1);return o.useEffect(()=>{const a=i=>{i.preventDefault(),s(i),t(!0)};return window.addEventListener("beforeinstallprompt",a),()=>{window.removeEventListener("beforeinstallprompt",a)}},[]),{canInstall:n,install:async()=>{if(!r)return;await r.prompt(),(await r.userChoice).outcome==="accepted"&&(s(null),t(!1))}}}function D(){const{canInstall:r,install:s}=R(),[n,t]=o.useState(!1);return!r||n?null:e.jsx("div",{className:"fixed inset-x-0 bottom-4 z-50 flex justify-center px-4",children:e.jsxs("div",{className:"flex w-full max-w-md items-center gap-3 rounded-2xl bg-purple-600 px-4 py-3 text-white shadow-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold",children:"Instala Findy"}),e.jsx("p",{className:"text-xs opacity-90",children:"Acceso rápido y funciona offline"})]}),e.jsx("button",{onClick:s,className:"rounded-xl bg-white/20 p-2 transition hover:bg-white/30",children:e.jsx(E,{size:18})}),e.jsx("button",{onClick:()=>t(!0),className:"rounded-xl bg-white/10 p-2 transition hover:bg-white/20",children:e.jsx(N,{size:16})})]})})}function U({onRefresh:r}){return e.jsx(L.div,{initial:{y:80,opacity:0},animate:{y:0,opacity:1},exit:{y:80,opacity:0},className:"fixed inset-x-4 bottom-4 z-50 rounded-2xl bg-purple-600 px-4 py-3 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Nueva versión disponible"}),e.jsx("button",{onClick:r,className:"rounded-xl bg-white/20 px-3 py-1.5 text-xs font-bold backdrop-blur hover:bg-white/30",children:"Actualizar"})]})})}function H(){const[r,s]=o.useState(!1),[n,t]=o.useState(null);return o.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(a=>{a.waiting&&(t(a.waiting),s(!0)),a.addEventListener("updatefound",()=>{const i=a.installing;i&&i.addEventListener("statechange",()=>{i.state==="installed"&&navigator.serviceWorker.controller&&(t(i),s(!0))})})})},[]),{updateAvailable:r,refreshApp:()=>{n&&(n.postMessage("SKIP_WAITING"),window.location.reload())}}}function q({children:r,showFloatShoppingCart:s=!0}){const[n,t]=o.useState(!1),{cart:l,auth:a}=m().props,i=Object.values(l),x=a?.user,c=i.length,{updateAvailable:d,refreshApp:p}=H();return e.jsxs("main",{className:"relative z-10 mx-auto min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-0 md:px-4 md:pt-4",children:[e.jsx(y,{position:"top-right",className:"!z-[9999]",autoClose:1800}),e.jsx(F,{}),e.jsxs("div",{className:"relative z-10 w-full max-w-6xl p-1 md:mx-auto md:max-w-7xl",children:[r,d&&e.jsx(U,{onRefresh:p}),e.jsx(D,{})]}),x&&e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"fixed right-4 bottom-24 z-[40] md:right-8 md:bottom-8",children:e.jsx(O,{totalItems:c,onClick:()=>t(!0)})}),e.jsx(P,{isOpen:n,onClose:()=>t(!1)})]}),e.jsx(W,{})]})}export{q as M};
