import{r as x,j as e,u as Y}from"./app-DkDB_8CB.js";import{B as Z}from"./badge-YEy5JNqo.js";import{B as V}from"./button-Bts0IyD1.js";import{C as F}from"./card-DBCK3lRd.js";import{u as q}from"./index-tO81QAJn.js";import{P as B,a as ee,c as M,b as se}from"./index-Cybp8v3T.js";import{u as te}from"./index-C2BrnB1H.js";import{u as ae}from"./index-iub-ua1H.js";import{P as re}from"./index-CcpYGMtr.js";import{A as ne,c as oe,b as ce,B as le}from"./utils-CfzZyKvo.js";import{I}from"./input-C3D08c3E.js";import{L as w}from"./label-BQKXPnzX.js";import{S as O}from"./switch-B08DHOq7.js";import{L as ie}from"./loader-circle-CkAJu07Z.js";import{X as de}from"./x-BURC3Ppq.js";import{C as me}from"./package-BU1OvDV9.js";import"./app-CGfczU0M.js";import"./clsx--lBOLjvq.js";import"./createLucideIcon-a_qB-A08.js";import"./shopping-bag-DxRCLEcD.js";import"./arrow-right-BkUc17Rt.js";import"./circle-alert-BM5BSp8j.js";import"./printer-DRzafObI.js";import"./house-BKZxKSjy.js";import"./shield-check-DJA5_I73.js";import"./star-BJgUuVE2.js";import"./trash-2-BdFRsBj0.js";import"./package-search-DrzKzZru.js";import"./plus-Cz8WvdQW.js";import"./shopping-cart-Cxh0H1UY.js";import"./triangle-alert-CccrTqft.js";import"./index-C47cWYbP.js";var R="Checkbox",[pe]=se(R),[he,L]=pe(R);function ue(n){const{__scopeCheckbox:l,checked:b,children:f,defaultChecked:p,disabled:r,form:t,name:c,onCheckedChange:g,required:N,value:i="on",internal_do_not_use_render:o}=n,[j,k]=ee({prop:b,defaultProp:p??!1,onChange:g,caller:R}),[v,h]=x.useState(null),[C,m]=x.useState(null),u=x.useRef(!1),_=v?!!t||!!v.closest("form"):!0,E={checked:j,disabled:r,setChecked:k,control:v,setControl:h,name:c,form:t,value:i,hasConsumerStoppedPropagationRef:u,required:N,defaultChecked:y(p)?!1:p,isFormControl:_,bubbleInput:C,setBubbleInput:m};return e.jsx(he,{scope:l,...E,children:xe(o)?o(E):f})}var H="CheckboxTrigger",K=x.forwardRef(({__scopeCheckbox:n,onKeyDown:l,onClick:b,...f},p)=>{const{control:r,value:t,disabled:c,checked:g,required:N,setControl:i,setChecked:o,hasConsumerStoppedPropagationRef:j,isFormControl:k,bubbleInput:v}=L(H,n),h=q(p,i),C=x.useRef(g);return x.useEffect(()=>{const m=r?.form;if(m){const u=()=>o(C.current);return m.addEventListener("reset",u),()=>m.removeEventListener("reset",u)}},[r,o]),e.jsx(B.button,{type:"button",role:"checkbox","aria-checked":y(g)?"mixed":g,"aria-required":N,"data-state":Q(g),"data-disabled":c?"":void 0,disabled:c,value:t,...f,ref:h,onKeyDown:M(l,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:M(b,m=>{o(u=>y(u)?!0:!u),v&&k&&(j.current=m.isPropagationStopped(),j.current||m.stopPropagation())})})});K.displayName=H;var X=x.forwardRef((n,l)=>{const{__scopeCheckbox:b,name:f,checked:p,defaultChecked:r,required:t,disabled:c,value:g,onCheckedChange:N,form:i,...o}=n;return e.jsx(ue,{__scopeCheckbox:b,checked:p,defaultChecked:r,disabled:c,required:t,onCheckedChange:N,name:f,form:i,value:g,internal_do_not_use_render:({isFormControl:j})=>e.jsxs(e.Fragment,{children:[e.jsx(K,{...o,ref:l,__scopeCheckbox:b}),j&&e.jsx(J,{__scopeCheckbox:b})]})})});X.displayName=R;var $="CheckboxIndicator",U=x.forwardRef((n,l)=>{const{__scopeCheckbox:b,forceMount:f,...p}=n,r=L($,b);return e.jsx(re,{present:f||y(r.checked)||r.checked===!0,children:e.jsx(B.span,{"data-state":Q(r.checked),"data-disabled":r.disabled?"":void 0,...p,ref:l,style:{pointerEvents:"none",...n.style}})})});U.displayName=$;var W="CheckboxBubbleInput",J=x.forwardRef(({__scopeCheckbox:n,...l},b)=>{const{control:f,hasConsumerStoppedPropagationRef:p,checked:r,defaultChecked:t,required:c,disabled:g,name:N,value:i,form:o,bubbleInput:j,setBubbleInput:k}=L(W,n),v=q(b,k),h=te(r),C=ae(f);x.useEffect(()=>{const u=j;if(!u)return;const _=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(_,"checked").set,P=!p.current;if(h!==r&&S){const T=new Event("click",{bubbles:P});u.indeterminate=y(r),S.call(u,y(r)?!1:r),u.dispatchEvent(T)}},[j,h,r,p]);const m=x.useRef(y(r)?!1:r);return e.jsx(B.input,{type:"checkbox","aria-hidden":!0,defaultChecked:t??m.current,required:c,disabled:g,name:N,value:i,form:o,...l,tabIndex:-1,ref:v,style:{...l.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});J.displayName=W;function xe(n){return typeof n=="function"}function y(n){return n==="indeterminate"}function Q(n){return y(n)?"indeterminate":n?"checked":"unchecked"}function z({className:n,...l}){return e.jsx(X,{"data-slot":"checkbox",className:oe("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),...l,children:e.jsx(U,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ne,{className:"size-3.5"})})})}const be={id:void 0,name:"",phone:"",use_whatsapp:!0,description:"",long_description:"",id_category:"",address:"",tags:"",amenities:[],payments:[],schedules:[]},G=6,fe=4;function Qe({categories:n,initialValues:l,submitUrl:b,onSuccess:f,payments:p,services:r}){const{data:t,setData:c,transform:g,put:N,processing:i,errors:o,wasSuccessful:j}=Y({...be,...l,amenities:l?.amenities?.map(s=>s.id)??[],payments:l?.payments?.map(s=>s.id)??[],schedules:l?.schedules?.map(s=>s)??[]}),[k,v]=x.useState(""),[h,C]=x.useState([...l.tags??[]]),m=s=>{s.preventDefault(),g(a=>({...a,tags:h.join(",")})),N(b)},u=(s,a)=>{a?c("amenities",[...t.amenities,s]):c("amenities",t.amenities.filter(d=>d!==s))},_=(s,a)=>{a?c("payments",[...t.payments,s]):c("payments",t.payments.filter(d=>d!==s))};x.useEffect(()=>{j&&f&&f()},[j]);const E=s=>{s.key==="Enter"&&(s.preventDefault(),S())},S=()=>{const s=k.trim().toLowerCase();D(s,h)&&(C([...h,s]),v(""))},P=(s,a,d)=>{const A=[...t.schedules];A[s]={...A[s],[a]:d},c("schedules",A)},T=s=>{C(a=>a.filter(d=>d!==s))},D=(s,a)=>{const d=s.trim().toLowerCase();return d.length>=fe&&!a.includes(d)&&a.length<G};return e.jsxs("form",{className:"relative flex w-full flex-col gap-2 rounded-xl p-1 p-3 lg:w-12/12 xl:flex-row",onSubmit:m,children:[e.jsx("button",{type:"submit",disabled:i,className:"absolute top-0 right-2 mt-6 flex cursor-pointer items-center justify-center gap-2 rounded-lg bg-orange-600 p-2 text-white shadow hover:scale-105 hover:bg-orange-700 disabled:opacity-50",title:"Guardar",children:i?e.jsx(ie,{className:"h-4 w-4 animate-spin duration-400"}):e.jsx(ce,{className:"h-5 w-5"})}),e.jsxs(F,{className:"flex w-full flex-col gap-2 p-3 xl:w-6/12",children:[e.jsxs("h3",{className:"mt-2 mb-4 mb-5 flex items-center gap-3 text-lg font-bold",children:["Datos generales",e.jsx(le,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"my-3 md:col-span-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Nombre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(I,{type:"text",value:t.name,onChange:s=>c("name",s.target.value),className:"mt-1 block w-full rounded-xl border border-gray-200 p-2",placeholder:"Ingresa el nombre",disabled:i}),o.name&&e.jsx("div",{className:"mt-1 text-sm text-red-500",children:o.name})]}),e.jsxs("div",{className:"my-3 md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Descripción ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.description,onChange:s=>c("description",s.target.value),className:"mt-1 block w-full rounded-xl border border-gray-200 p-2",maxLength:100,disabled:i}),o.description&&e.jsx("div",{className:"mt-1 text-sm text-red-500",children:o.description}),e.jsxs("span",{className:"text-sm font-bold text-gray-700/60",children:["Caracteres restantes -"," ",100-t.description.length]})]}),e.jsxs("div",{className:"my-3 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Descripción larga"}),e.jsx("textarea",{value:t.long_description,onChange:s=>c("long_description",s.target.value),className:"mt-1 block w-full rounded-xl border border-gray-200 p-2",rows:8,maxLength:1e3,disabled:i}),o.description&&e.jsx("div",{className:"mt-1 text-sm text-red-500",children:o.long_description}),e.jsxs("span",{className:"text-sm font-bold text-gray-700/60",children:["Caracteres restantes -"," ",1e3-t.long_description.length]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Categoría ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:t.id_category,onChange:s=>c("id_category",s.target.value),className:"mt-1 block w-full rounded-xl border border-gray-200 p-2",disabled:i,children:[e.jsx("option",{value:"",children:"Selecciona una categoría"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),o.id_category&&e.jsx("div",{className:"mt-1 text-sm text-red-500",children:o.id_category})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Teléfono",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(I,{type:"tel",value:t.phone,onChange:s=>c("phone",s.target.value.replace(/\D/g,"")),className:"my-1 block w-full rounded-xl border border-gray-200 p-2",placeholder:"1234567890",maxLength:10,disabled:i}),e.jsxs(w,{className:"flex items-center gap-3 text-sm",children:["¿Usar para WhatsApp?",e.jsx(O,{checked:t.use_whatsapp,onCheckedChange:s=>{c("use_whatsapp",s)},className:"border-gray-300 data-[state=checked]:bg-emerald-500",disabled:i})]}),o.phone&&e.jsx("div",{className:"mt-1 text-sm text-red-500",children:o.phone})]})]}),e.jsxs("div",{className:"mt-3 border-t pt-5",children:[e.jsxs("h3",{className:"mt-3 mb-0 text-lg font-semibold",children:["Palabras claves -"," ",e.jsxs("span",{className:"text-sm text-gray-500",children:[" ","(",h.length,")"," "]})]}),e.jsx("span",{className:"mb-5 text-sm text-gray-500",children:"(Deben ser mínimo 4 caracteres)"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{id:"tags",value:k,onChange:s=>v(s.target.value),onKeyDown:E,placeholder:"pizza, tlayudas, hamburguesas, ...",disabled:h.length>=G}),e.jsx(V,{type:"button",onClick:S,variant:"outline",disabled:!D(k,h),children:"Agregar"})]})}),e.jsx("div",{className:"my-3 flex gap-1",children:h.map(function(s){return e.jsxs(Z,{className:"flex items-center gap-1 bg-orange-600/80 px-2 py-1 text-sm",children:[e.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),T(s)},className:"ml-1 cursor-pointer rounded-full p-0.5 hover:bg-black/20",children:e.jsx(de,{className:"h-4 w-4 text-white"})}),s]},`tag-${s}`)})})]}),e.jsxs("div",{className:"my-5 space-y-4 border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Amenidades"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:r.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{id:`service-${s.id}`,checked:t.amenities.includes(s.id),onCheckedChange:a=>u(s.id,a===!0),disabled:i,className:"data-[state=checked]:border-emerald-500 data-[state=checked]:bg-emerald-500"}),e.jsx(w,{htmlFor:`service-${s.id}`,className:"cursor-pointer font-normal",children:s.name})]},s.id))})]}),e.jsxs("div",{className:"my-5 space-y-4 border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Tipos de pago"}),e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:p.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{id:s.id,checked:t.payments.includes(s.id),onCheckedChange:a=>_(s.id,a===!0),className:"data-[state=checked]:border-emerald-500 data-[state=checked]:bg-emerald-500"}),e.jsx(w,{htmlFor:s.id,className:"cursor-pointer font-normal",children:s.name})]},s.id))})]})]}),e.jsxs(F,{className:"w-full p-3 xl:w-6/12",children:[e.jsxs("h3",{className:"mt-2 mb-4 flex items-center gap-3 text-lg font-bold",children:["Horarios",e.jsx(me,{className:"h-4 w-4"})]}),e.jsx("div",{className:"space-y-4",children:t.schedules.map((s,a)=>e.jsxs("div",{className:"space-y-2 rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{className:"text-md font-semibold",children:s.label}),e.jsxs(w,{className:"text-md flex cursor-pointer gap-2 font-semibold",children:[e.jsx("span",{children:s.isOpen?"Abierto":"Cerrado"}),e.jsx(O,{checked:s.isOpen,onCheckedChange:d=>{P(a,"isOpen",d)},className:"cursor-pointer data-[state=checked]:bg-emerald-500"})]})]}),s.isOpen&&e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(w,{className:"text-sm",children:"Apertura"}),e.jsx(I,{type:"time",value:s.open,onChange:d=>P(a,"open",d.target.value)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(w,{className:"text-sm",children:"Cierre"}),e.jsx(I,{type:"time",value:s.close,onChange:d=>P(a,"close",d.target.value)})]})]})]},a))})]})]})}export{Qe as default};
