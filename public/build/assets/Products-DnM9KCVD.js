import{j as e,r as o,a as k,d as v}from"./vendor-core-VmliHTPN.js";import{_ as A}from"./app-B6TFEqqM.js";import{H as E,J as S,K as P,M as _,N as z,Q as T,U as O,W as M}from"./vendor-ui-BLZZ21YU.js";import{c as n}from"./utils-DA-8Si8A.js";import{b as C,B as b}from"./button-QYsVwpqb.js";import{e as $,c as y,I,T as L,a8 as B}from"./vendor-icons-AXEXEb4U.js";import{y as H}from"./index-DdSA57g9.js";import{m as R}from"./dashboard-layout-DctQTAKd.js";import{LayoutBusinessModules as q}from"./LayoutBusinessModules-BaadMert.js";import F from"./ProductServiceModal-BU6_T75e.js";import"./app-D1mVeRFJ.js";import"./dropdown-menu-CWFYYrp0.js";import"./index-BCw_eWvc.js";import"./index-CVASjcgI.js";import"./dialog-vzLoSVqm.js";import"./input-pk9gV_sk.js";import"./label-Du_iRzIw.js";import"./select-Dqv_fT9E.js";import"./tabs-DD4pG0HE.js";import"./textarea-BmKvYVVQ.js";function V({...t}){return e.jsx(E,{"data-slot":"alert-dialog",...t})}function W({...t}){return e.jsx(O,{"data-slot":"alert-dialog-portal",...t})}function J({className:t,...a}){return e.jsx(M,{"data-slot":"alert-dialog-overlay",className:n("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function K({className:t,...a}){return e.jsxs(W,{children:[e.jsx(J,{}),e.jsx(S,{"data-slot":"alert-dialog-content",className:n("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function Q({className:t,...a}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:n("flex flex-col gap-2 text-center sm:text-left",t),...a})}function U({className:t,...a}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:n("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function G({className:t,...a}){return e.jsx(P,{"data-slot":"alert-dialog-title",className:n("text-lg font-semibold",t),...a})}function X({className:t,...a}){return e.jsx(_,{"data-slot":"alert-dialog-description",className:n("text-muted-foreground text-sm",t),...a})}function Y({className:t,...a}){return e.jsx(T,{className:n(C(),t),...a})}function Z({className:t,...a}){return e.jsx(z,{className:n(C({variant:"outline"}),t),...a})}function ee({title:t="¿Estás seguro?",description:a="Esta acción no se puede deshacer.",confirmText:i="Confirmar",cancelText:l="Cancelar",onConfirm:m,onResolve:r}){const[u,c]=o.useState(!0),[p,d]=o.useState(!1),x=()=>{r(!1),c(!1)},f=async()=>{try{d(!0),await m?.(),r(!0)}catch{r(!1)}finally{d(!1),c(!1)}};return k.createPortal(e.jsx(V,{open:u,onOpenChange:c,children:e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsx(G,{children:t}),e.jsx(X,{children:a})]}),e.jsxs(U,{children:[e.jsx(Z,{disabled:p,onClick:x,className:"flex items-center gap-2 border-none bg-gray-50 text-gray-500 hover:bg-gray-100 hover:text-gray-600",children:l}),e.jsxs(Y,{disabled:p,onClick:f,className:"flex items-center gap-2 border-none bg-red-50 text-red-600 shadow-none hover:bg-red-100 hover:text-red-700",children:[p&&e.jsx($,{className:"h-4 w-4 animate-spin"}),i]})]})]})}),document.body)}function te(t){return new Promise(a=>{const i=document.createElement("div");document.body.appendChild(i);const l=()=>{setTimeout(()=>{i.remove()},200)},m=()=>(o.useEffect(()=>l,[]),e.jsx(ee,{...t,onResolve:r=>{a(r),l()}}));A(()=>import("./vendor-core-VmliHTPN.js").then(r=>r.c),[]).then(r=>{r.createRoot(i).render(e.jsx(m,{}))})})}function ye({business:t,productsAndServices:a,productTypes:i}){const l=a,[m,r]=o.useState(!1),[u,c]=o.useState(null),p=R({text:`${t.name??""} - Catálogo`,url:"#"}),d=o.useCallback(()=>{v.reload({only:["productsAndServices"]})},[]),x=o.useCallback(()=>{c(null),r(!0)},[]),f=o.useCallback(s=>{c(s),r(!0)},[]),j=o.useCallback(()=>{c(null),r(!1)},[]),w=o.useCallback(async(s,g)=>{if(!s||!g)return;const h=null;await te({title:"¿Eliminar producto?",description:"Esta acción no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",onConfirm:async()=>{v.delete(`/dashboard/business/${s}-${h}/services/${g}`,{onSuccess:D=>{const N=D.props.flash;N?.success&&(H.success(N.success),d())}})}})},[d]);return e.jsxs(q,{titleHead:"Catálogo",headerTitle:"Productos y Servicios",headerDescription:`${l.length} artículos registrados`,buttonText:"Nuevo Producto",icon:y,processing:!1,breadcrumbs:p,onSubmit:x,children:[e.jsx("div",{className:"lg:col-span-12",children:l.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-6",children:l.map(s=>{const g=typeof s.image_url=="string"&&s.image_url.trim()!=="",h=Number.isFinite(Number(s.price))?Number(s.price).toLocaleString():"0";return e.jsxs("div",{className:"group flex flex-col overflow-hidden rounded-lg border border-purple-200 bg-white shadow-sm transition hover:shadow-md",children:[e.jsxs("div",{className:"relative aspect-square h-55 w-full overflow-hidden bg-purple-50",children:[g?e.jsx("img",{src:s.image_url,alt:s.name||"Producto",className:"h-20 w-full object-cover transition-transform group-hover:scale-105"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center text-gray-300",children:e.jsx(I,{size:36})}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("span",{className:"rounded-lg bg-white/90 px-2 py-1 text-xs font-semibold text-purple-700 shadow-sm backdrop-blur-sm",children:["$",h]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col p-3",children:[e.jsx("h4",{className:"line-clamp-1 text-sm font-semibold text-purple-800",children:s.name}),e.jsx("p",{className:"mt-1 line-clamp-2 min-h-[32px] text-xs font-normal text-gray-500",children:s.description||"Sin descripción disponible."}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 border-t border-purple-100 pt-3",children:[e.jsx(b,{size:"icon",variant:"ghost","aria-label":"Eliminar producto",className:"h-8 w-8 cursor-pointer rounded-lg text-gray-300 transition-colors hover:bg-red-50 hover:text-red-600 active:scale-95",onClick:()=>w(s.businesses_id,s.id),children:e.jsx(L,{size:14})}),e.jsxs(b,{size:"sm",className:"h-8 flex-1 cursor-pointer rounded-lg bg-purple-600 text-xs font-semibold text-white transition-all hover:bg-purple-700 active:scale-95",onClick:()=>f(s),children:[e.jsx(B,{size:14,className:"mr-2"}),"Editar"]})]})]})]},s.id)})}):e.jsxs("div",{className:"flex w-full flex-col items-center justify-center rounded-lg border border-dashed border-gray-200 bg-gray-50/50 py-16 text-center",children:[e.jsx(y,{size:40,className:"mb-3 text-gray-300"}),e.jsx("p",{className:"text-base font-semibold text-gray-700",children:"No hay productos aún"}),e.jsx("p",{className:"mb-4 text-sm text-gray-500",children:"Comienza agregando artículos a tu catálogo."}),e.jsx(b,{onClick:x,variant:"link",className:"text-sm font-semibold text-purple-600 active:scale-95",children:"Crear el primero"})]})}),e.jsx(F,{open:m,onClose:j,businessId:t.id??"",product:u,onSuccess:()=>{d(),j()},productTypes:i},u?.id??"create")]})}export{ye as default};
