import{u as C,r as D,j as e}from"./vendor-core-exSyXSqW.js";import{y as S}from"./index-zdFYkwEh.js";import{B as o}from"./button-DROHPe1W.js";import{D as T,a as z,b as k,c as E}from"./dialog-BGXOj8Cw.js";import{I as d}from"./input-3TT18shE.js";import{L as m}from"./label-BJtWGace.js";import{S as L,a as P,b as _,c as $,d as A}from"./select-BqBcghbi.js";import{T as B,a as I,b as u,c as h}from"./tabs-CQj0A8yx.js";import{T as F}from"./textarea-Cvy6BSFk.js";import{c as N}from"./utils-ZvPxgyVA.js";import{b as G,P as x,c as V,d as R,T as v,I as O,e as U,f as q}from"./vendor-icons-C0rekE6d.js";import"./vendor-ui-BC6GVMXR.js";const i={label:"text-[10px] font-semibold tracking-widest text-gray-500 uppercase leading-tight mb-1 block",input:"rounded-lg border-purple-200 bg-white text-sm shadow-sm transition focus:border-purple-600 focus:ring-1 focus:ring-purple-600/20",tabTrigger:"relative rounded-none border-b-2 border-transparent bg-transparent px-1 text-sm font-semibold text-gray-400 transition-all hover:text-purple-500 data-[state=active]:border-purple-600 data-[state=active]:text-purple-700"};function re({open:p,onClose:g,businessId:b,product:t,onSuccess:f,productTypes:y}){const a=C({name:"",description:"",price:"",duration:"",category:"",isActive:!0,image:void 0,image_url:"",extras:[],variations:[]});D.useEffect(()=>{p&&(t?a.setData({name:t.name??"",description:t.description??"",price:String(t.price??""),duration:String(t.duration??""),category:String(t.category??""),isActive:!!(t.isActive??!0),image:void 0,image_url:t.image_url??"",extras:t.extras??[],variations:t.variations??[]}):(a.reset(),a.clearErrors()))},[p,t]);const w=()=>{const s=!!t,r=s?`/dashboard/business/${b}-null/services/${t?.id}`:`/dashboard/business/${b}-null/services`;s&&a.transform(l=>({...l})),a.post(r,{forceFormData:!0,onSuccess:()=>{S.success(s?"Actualizado correctamente":"Creado correctamente"),g(),f(),a.reset()}})},c=s=>{const r=a.errors[s];return r?e.jsx("span",{className:"ml-1 text-[10px] font-medium text-red-500",children:r}):null};return e.jsx(T,{open:p,onOpenChange:g,children:e.jsxs(z,{className:"max-w-4xl overflow-hidden rounded-lg border-none bg-gray-50 p-0 shadow-2xl",children:[e.jsx("div",{className:"border-b border-purple-100 bg-white px-6 py-4",children:e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-purple-50 text-purple-700",children:t?e.jsx(G,{size:20}):e.jsx(x,{size:20})}),e.jsxs("div",{children:[e.jsx(E,{className:"text-lg font-semibold text-purple-800",children:t?"Editar Producto":"Nuevo Producto"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Gestiona las propiedades y variantes de tu catálogo."})]})]})})}),e.jsxs(B,{defaultValue:"general",className:"w-full",children:[e.jsx("div",{className:"border-b border-gray-100 bg-white px-6",children:e.jsxs(I,{className:"flex justify-start gap-6 bg-transparent p-0",children:[e.jsx(u,{value:"general",className:i.tabTrigger,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{size:12})," General"]})}),e.jsx(u,{value:"variations",className:i.tabTrigger,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:12})," Variaciones (",a.data.variations.length,")"]})}),e.jsx(u,{value:"extras",className:i.tabTrigger,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{size:12})," Extras (",a.data.extras.length,")"]})})]})}),e.jsxs("div",{className:"max-h-[60vh] overflow-y-auto p-6",children:[e.jsxs(h,{value:"general",className:"mt-0 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:i.label,children:"Categoría"}),e.jsxs(L,{value:a.data.category?String(a.data.category):void 0,onValueChange:s=>a.setData("category",s),children:[e.jsx(P,{className:i.input,children:e.jsx(_,{placeholder:"Selecciona tipo"})}),e.jsx($,{children:y.map(s=>e.jsxs(A,{value:String(s.id),children:[s.icon," ",s.name]},s.id))})]}),c("category")]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:i.label,children:"Nombre del producto"}),e.jsx(d,{value:a.data.name,onChange:s=>a.setData("name",s.target.value),className:i.input}),c("name")]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:i.label,children:"Precio base"}),e.jsx(d,{type:"number",value:a.data.price,onChange:s=>a.setData("price",s.target.value),className:i.input}),c("price")]})]}),e.jsxs("div",{onClick:()=>document.getElementById("image-upload")?.click(),className:"relative flex aspect-square cursor-pointer flex-col items-center justify-center overflow-hidden rounded-lg border-2 border-dashed border-purple-200 bg-white transition hover:border-purple-400 active:scale-95",children:[a.data.image||a.data.image_url?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a.data.image?URL.createObjectURL(a.data.image):a.data.image_url,className:"h-full w-full object-cover p-2"}),e.jsx(o,{variant:"destructive",size:"icon",className:"absolute top-3 right-3 h-7 w-7 rounded-full",onClick:s=>{s.stopPropagation(),a.setData({...a.data,image:void 0,image_url:""})},children:e.jsx(v,{size:14})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(O,{className:"mx-auto mb-2 text-gray-300",size:32}),e.jsx("span",{className:"text-xs font-medium text-gray-400",children:"Subir imagen"})]}),e.jsx("input",{id:"image-upload",type:"file",className:"hidden",onChange:s=>a.setData("image",s.target.files?.[0])})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{className:i.label,children:"Descripción"}),e.jsx(F,{value:a.data.description,onChange:s=>a.setData("description",s.target.value),className:N(i.input,"min-h-[100px]",a.errors.description&&"border-red-500")}),c("description")]})]}),e.jsxs(h,{value:"variations",className:"mt-0 space-y-3",children:[a.data.variations.map((s,r)=>{const l=!!a.errors[`variations.${r}.name`];return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:N("flex items-center gap-2 rounded-lg border bg-white p-1 transition-all",l?"border-red-500 shadow-red-50":"border-purple-100"),children:[e.jsx(d,{value:s.name,placeholder:"Ej: Tamaño Grande",className:"border-none bg-transparent font-semibold text-purple-800 focus:ring-0",onChange:n=>{const j=[...a.data.variations];j[r].name=n.target.value,a.setData("variations",j)}}),e.jsx(o,{variant:"ghost",size:"icon",className:"text-gray-300 hover:text-red-500",onClick:()=>{const n=[...a.data.variations];n.splice(r,1),a.setData("variations",n)},children:e.jsx(v,{size:16})})]}),c(`variations.${r}.name`)]},r)}),e.jsxs(o,{variant:"outline",className:"w-full border-dashed border-purple-300 text-purple-600",onClick:()=>a.setData("variations",[...a.data.variations,{name:""}]),children:[e.jsx(x,{size:16,className:"mr-2"})," Agregar variación"]})]}),e.jsxs(h,{value:"extras",className:"mt-0 space-y-3",children:[a.data.extras.map((s,r)=>e.jsxs("div",{className:"grid grid-cols-[1fr_120px_auto] items-start gap-3 rounded-lg border border-purple-100 bg-white p-2 shadow-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{value:s.name,placeholder:"Nombre extra",className:"border-none bg-transparent font-semibold text-purple-800 focus:ring-0",onChange:l=>{const n=[...a.data.extras];n[r].name=l.target.value,a.setData("extras",n)}}),c(`extras.${r}.name`)]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{type:"number",value:s.price,className:"h-8 border-purple-100 bg-purple-50/50 font-mono text-xs",onChange:l=>{const n=[...a.data.extras];n[r].price=Number(l.target.value),a.setData("extras",n)}}),c(`extras.${r}.price`)]}),e.jsx(o,{variant:"ghost",size:"icon",className:"text-gray-300 hover:text-red-500",onClick:()=>{const l=[...a.data.extras];l.splice(r,1),a.setData("extras",l)},children:e.jsx(v,{size:16})})]},r)),e.jsxs(o,{variant:"outline",className:"w-full border-dashed border-purple-300 text-purple-600",onClick:()=>a.setData("extras",[...a.data.extras,{name:"",price:0}]),children:[e.jsx(x,{size:16,className:"mr-2"})," Agregar extra"]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 border-t border-purple-100 bg-white px-6 py-4",children:[e.jsx(o,{variant:"ghost",onClick:g,className:"text-gray-500",children:"Cancelar"}),e.jsx(o,{onClick:w,disabled:a.processing,className:"bg-purple-600 px-6 font-semibold text-white hover:bg-purple-700 active:scale-95 disabled:opacity-50",children:a.processing?e.jsx(U,{className:"animate-spin",size:18}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2",size:18})," Guardar cambios"]})})]})]})})}export{re as default};
