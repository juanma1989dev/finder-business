const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainFilters-Mn6CNZYA.js","assets/app-DRnaFo71.js","assets/app-_ZmoGD8T.js","assets/app-CjN5z7Fi.css","assets/star-C33ZpR1w.js","assets/createLucideIcon-8cOpsgex.js","assets/utils-B8V9t6OR.js","assets/clsx-COCWedHH.js","assets/shopping-bag-D6HcC1f4.js","assets/arrow-right-FvoTZcqC.js","assets/circle-alert-DLeoRx40.js","assets/printer-CQ4wc93D.js","assets/package-PXuZgzM8.js","assets/house-BvvIOFlQ.js","assets/shield-check-DZxu-W88.js","assets/loader-circle-DK9NHL9l.js","assets/trash-2-B_LJmt8F.js","assets/package-search-CwpuKR2z.js","assets/plus-D6693a4f.js","assets/shopping-cart-CMRXSugC.js","assets/triangle-alert-BPl7zri6.js","assets/x-BkmaQkV6.js"])))=>i.map(i=>d[i]);
import{r as s,b as D,a as L,j as e,_ as T}from"./app-DRnaFo71.js";import{B as O}from"./BusinessCard-CeggTFVg.js";import{D as P,a as q,b as A,c as R}from"./dialog-AbUjPycv.js";import{M as F}from"./main-layout-CQX9fiUz.js";import{C as G}from"./circle-alert-DLeoRx40.js";import{a as H}from"./star-C33ZpR1w.js";import{C as M}from"./printer-CQ4wc93D.js";import"./app-_ZmoGD8T.js";import"./arrow-right-FvoTZcqC.js";import"./createLucideIcon-8cOpsgex.js";import"./index-DXUyvkal.js";import"./index-CDS2P9IT.js";import"./index-DAOhb2hJ.js";import"./index-_ty5M1Kx.js";import"./index-CJG-LqGM.js";import"./utils-B8V9t6OR.js";import"./clsx-COCWedHH.js";import"./shopping-bag-D6HcC1f4.js";import"./package-PXuZgzM8.js";import"./house-BvvIOFlQ.js";import"./shield-check-DZxu-W88.js";import"./loader-circle-DK9NHL9l.js";import"./trash-2-B_LJmt8F.js";import"./package-search-CwpuKR2z.js";import"./plus-D6693a4f.js";import"./shopping-cart-CMRXSugC.js";import"./triangle-alert-BPl7zri6.js";import"./x-BkmaQkV6.js";import"./index-Dgc8qQOq.js";import"./CartFloatButton-D4EB0M0C.js";import"./drawer-cart-3Fke6IOU.js";function z(r){const t=r?.enabled??!0,[a,i]=s.useState(null),[j,m]=s.useState(null),[c,n]=s.useState(!1),[d,u]=s.useState(null);return s.useEffect(()=>{if(t){if(!navigator.geolocation){u("Geolocation not supported");return}n(!0),navigator.geolocation.getCurrentPosition(p=>{i(p.coords.latitude),m(p.coords.longitude),n(!1)},()=>{u("Permission denied"),n(!1)},{enableHighAccuracy:r?.enableHighAccuracy??!1})}},[t]),{latitude:a,longitude:j,loading:c,error:d}}const B=s.lazy(()=>T(()=>import("./MainFilters-Mn6CNZYA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),v=[{key:"pending",label:"Creado"},{key:"confirmed",label:"Confirmado"},{key:"ready_for_pickup",label:"Listo para recoger"},{key:"picked_up",label:"Recogido"},{key:"on_the_way",label:"En camino"},{key:"delivered",label:"Entregado"}];function ke({businesses:r,categories:t,filters:a,products:i,activeOrder:j}){const{auth:m}=D().props;m.user;const c=s.useRef(!0),[n,d]=s.useState(!1),[u,p]=s.useState(!0),[y,N]=s.useState(!1),[x,V]=s.useState(null),[o,S]=s.useState({query:a.q||"",category:a.category||null,distance:a.distance||5,foodType:null}),[k,w]=s.useState(!1),{latitude:g,longitude:f,error:E,loading:b}=z(k?{enableHighAccuracy:!0}:null);s.useEffect(()=>{const l=setTimeout(()=>w(!0),1e3);return()=>clearTimeout(l)},[]);const C=s.useCallback(()=>{d(!0);const l={q:o.query,category:o.category,distance:o.distance,foodType:o.foodType},h={};g&&f&&(h["X-Latitude"]=g.toString(),h["X-Longitude"]=f.toString()),L.get("/",l,{headers:h,preserveState:!0,preserveScroll:!0,replace:!0,onFinish:()=>d(!1)})},[o,g,f]);s.useEffect(()=>{if(c.current){c.current=!1;return}b||C()},[o]);const _=n||r.length===0&&b;return e.jsxs(F,{children:[e.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-30 bg-white/80 backdrop-blur-xl",children:[e.jsx("div",{className:"px-4 pt-2 pb-3",children:e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"h-16"}),children:e.jsx(B,{categories:t,filters:o,onFiltersChange:S,foodTypes:i.categories})})}),E&&e.jsxs("div",{className:"mx-4 mb-2 flex items-center gap-2 rounded-full bg-amber-50 py-1 text-amber-600",children:[e.jsx(G,{size:12}),e.jsx("span",{className:"text-[10px] font-bold",children:"Habilita el GPS para ver distancia real"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-24",children:e.jsx("div",{className:"py-2",children:_?e.jsx(I,{}):r.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:r.map(l=>e.jsx(O,{business:l},l.id))}):e.jsxs("div",{className:"flex flex-col items-center py-20 opacity-40",children:[e.jsx(H,{size:48}),e.jsx("p",{className:"mt-4 text-sm",children:"Sin resultados por aquÃ­"})]})})})]}),y&&e.jsx(P,{open:y,onOpenChange:N,children:e.jsxs(q,{className:"bottom-0 w-full rounded-t-3xl p-0 sm:max-w-md",children:[e.jsx(A,{className:"p-4",children:e.jsxs(R,{children:["ORDEN #",x?.id]})}),x&&e.jsx(X,{order:x})]})})]})}const I=()=>e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((r,t)=>e.jsxs("div",{className:"animate-pulse rounded-[2rem] border bg-white p-2",children:[e.jsx("div",{className:"h-48 rounded-[1.6rem] bg-gray-200"}),e.jsxs("div",{className:"space-y-3 p-3",children:[e.jsx("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),e.jsx("div",{className:"h-3 w-1/2 rounded bg-gray-200"}),e.jsx("div",{className:"h-8 rounded bg-gray-100"})]})]},t))}),U=s.memo(({status:r})=>{const t=v.findIndex(a=>a.key===r);return e.jsx("div",{className:"flex justify-between",children:v.map((a,i)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full border",children:i<t&&e.jsx(M,{className:"h-full w-full"})}),e.jsx("span",{className:"mt-1 text-[8px]",children:a.label})]},a.key))})}),X=s.memo(({order:r})=>e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(U,{status:r.status}),r.items.map(t=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[t.quantity,"x"]}),e.jsx("span",{children:t.name})]},t.id))]}));export{ke as default};
